# =============================================================================
# GRC Platform - Production Environment Configuration Template
# =============================================================================
# IMPORTANT: This is a TEMPLATE file. Copy to .env and fill in ALL values
# with production-appropriate settings BEFORE starting the application.
#
# Deployment model: Docker Compose on single app host (v1)
# Domain: niles-grc.com   API: /api (same domain, nginx strips prefix)
# TLS: terminated at corporate LB/ADC (nginx TLS fallback acceptable)
# DB: dedicated host on private network
#
# DO NOT commit actual production secrets to version control!
# =============================================================================

NODE_ENV=production
PORT=3002

# =============================================================================
# Database — Dedicated DB Host (private network)
# =============================================================================
# The DB host must be reachable from the app host on port 5432.
# Use a private IP or DNS name within the allowlisted network.
DB_HOST=<DB_HOST_PRIVATE_IP_OR_DNS>
DB_PORT=5432
DB_USER=grc_app_user
DB_PASSWORD=<STRONG_PASSWORD_HERE>
DB_NAME=grc_platform

# CRITICAL: Never enable DB_SYNC in production!
# Use database migrations instead: npm run migration:run:prod
DB_SYNC=false

# =============================================================================
# Security — JWT Secrets
# =============================================================================
# Generate with: openssl rand -base64 64
# Both secrets MUST be unique, strong, and at least 64 characters.
JWT_SECRET=<GENERATE_STRONG_SECRET_64_CHARS_MINIMUM>
JWT_EXPIRES_IN=8h
REFRESH_TOKEN_SECRET=<GENERATE_DIFFERENT_STRONG_SECRET_64_CHARS_MINIMUM>
REFRESH_TOKEN_EXPIRES_IN=7d

# =============================================================================
# CORS — Production Allowed Origins
# =============================================================================
# List ONLY your actual production domain(s). Comma-separated.
CORS_ORIGINS=https://niles-grc.com

# =============================================================================
# Demo Bootstrap — DISABLED by default in production
# =============================================================================
# The demo admin auto-creation is DISABLED unless ENABLE_DEMO_BOOTSTRAP=true.
# For first-time setup, enable temporarily, then disable and rotate credentials.
ENABLE_DEMO_BOOTSTRAP=false
DEMO_ADMIN_EMAIL=admin@niles-grc.com
DEMO_ADMIN_PASSWORD=<STRONG_PASSWORD_HERE>

# =============================================================================
# Audit Logging — Keep enabled for compliance
# =============================================================================
NEST_AUDIT_LOG_ENABLED=true

# =============================================================================
# Version Info (set by deploy pipeline, leave as-is)
# =============================================================================
GIT_COMMIT_SHA=unknown
GIT_COMMIT_SHORT=unknown
BUILD_TIMESTAMP=unknown

# =============================================================================
# Production Go-Live Checklist:
# =============================================================================
# [ ] All <PLACEHOLDER> values replaced with real credentials
# [ ] DB_HOST points to dedicated DB host (private network)
# [ ] DB_PASSWORD is strong and unique (not 'postgres')
# [ ] JWT_SECRET is at least 64 characters (openssl rand -base64 64)
# [ ] REFRESH_TOKEN_SECRET is different from JWT_SECRET
# [ ] DB_SYNC is set to false
# [ ] CORS_ORIGINS only includes production domain(s)
# [ ] ENABLE_DEMO_BOOTSTRAP=false (or remove entirely)
# [ ] DEMO_ADMIN_PASSWORD is strong (if bootstrap is used)
# [ ] TLS is configured at LB/ADC or in nginx
# [ ] Health checks configured in LB: /health/ready, /health/live
# [ ] All pending migrations applied: npm run migration:run:prod
# [ ] ops/preflight-go-live.sh passes all checks
# [ ] Logging aggregated to central system
# [ ] Monitoring and alerting configured
# =============================================================================
